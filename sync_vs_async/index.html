<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Sync vs Async - Django Socio gRPC Documentation</title>
  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Sync vs Async";
    var mkdocs_page_input_path = "sync_vs_async.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Django Socio gRPC Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generate_proto/">Generate Proto</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generic_service/">Generic Service</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../model_service/">Model Service</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../proto_serializer/">Proto Serializer</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Sync vs Async</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#sync-vs-async">Sync vs Async</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#the-different-imports">The different imports</a></li>
        
            <li><a class="toctree-l3" href="#the-usage-of-the-django-orm">The usage of the django ORM</a></li>
        
            <li><a class="toctree-l3" href="#the-grpc-api-difference-with-stream">The gRPC API difference with Stream</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../server_and_service_register/">Server and service register</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../permissions_and_authentication/">Permissions and Authentication</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../logging/">Logging</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../settings/">Settings</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../testing/">Testing</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Django Socio gRPC Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Sync vs Async</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="sync-vs-async">Sync vs Async</h2>
<p>Django Socio gRPC Framework actually support both async and sync mode for gRPC.</p>
<p>gRPC AsyncIO API is the new version of gRPC Python whose architecture is tailored to AsyncIO. So its the recommended usage. The change are minor in the API but major in the underlying stack. It will allow you to handle way more requests in some case. Specifically if you use streaming where using it in sync mode can block your whole server.</p>
<p>The Django Socio gRPC framework work the same in sync or async mode. But be carreful of some minor chnage in the import or in the Django ORM call.</p>
<h3 id="the-different-imports">The different imports</h3>
<table>
<thead>
<tr>
<th>Async Class</th>
<th>Sync class</th>
</tr>
</thead>
<tbody>
<tr>
<td>django_socio_grpc.mixins.AsyncCreateModelMixin</td>
<td>django_socio_grpc.mixins.CreateModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncListModelMixin</td>
<td>django_socio_grpc.mixins.ListModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncStreamModelMixin</td>
<td>django_socio_grpc.mixins.StreamModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncRetrieveModelMixin</td>
<td>django_socio_grpc.mixins.RetrieveModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncUpdateModelMixin</td>
<td>django_socio_grpc.mixins.UpdateModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncPartialUpdateModelMixin</td>
<td>django_socio_grpc.mixins.PartialUpdateModelMixin</td>
</tr>
<tr>
<td>django_socio_grpc.mixins.AsyncDestroyModelMixin</td>
<td>django_socio_grpc.mixins.DestroyModelMixin</td>
</tr>
<tr>
<td>---------------------</td>
<td>---------------------</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncCreateService</td>
<td>django_socio_grpc.generics.CreateService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncListService</td>
<td>django_socio_grpc.generics.ListService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncStreamService</td>
<td>django_socio_grpc.generics.StreamService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncRetrieveService</td>
<td>django_socio_grpc.generics.RetrieveService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncDestroyService</td>
<td>django_socio_grpc.generics.DestroyService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncUpdateService</td>
<td>django_socio_grpc.generics.UpdateService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncReadOnlyModelService</td>
<td>django_socio_grpc.generics.ReadOnlyModelService</td>
</tr>
<tr>
<td>django_socio_grpc.generics.AsyncModelService</td>
<td>django_socio_grpc.generics.class ModelService(</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="the-usage-of-the-django-orm">The usage of the django ORM</h3>
<p>The django ORM (in its verson &lt;=4.0) is currenctly not supporing async request. This way you can't use orm methodes inside an async context.
Fortunatly it exist wrapper from asgiref that allow you to wrap method sync method to use them in an async context.</p>
<p>See <a href="https://github.com/socotecio/django-socio-grpc/blob/master/django_socio_grpc/mixins.py#L284">example inside the mixins</a> to understand it and use it in your project</p>
<h3 id="the-grpc-api-difference-with-stream">The gRPC API difference with Stream</h3>
<p>The main advantage to use async api is the use of not blocking stream. Indeed instead of using a generator as stream answer we can now read and write data from the context where we need to.</p>
<p>The context is an instance of <a href="https://grpc.github.io/grpc/python/grpc_asyncio.html#grpc.aio.ServicerContext">ServicerContext</a> so for stream instance (methods defined as stream in the proto file) you have acess to read, write or both method depend on if you have your request, response or both marked as stream in the proto file.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../server_and_service_register/" class="btn btn-neutral float-right" title="Server and service register">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../proto_serializer/" class="btn btn-neutral" title="Proto Serializer"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../proto_serializer/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../server_and_service_register/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
